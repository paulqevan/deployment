<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Diabetes Prediction Demo</title>
  <style>
    body { font-family: system-ui, sans-serif; max-width: 820px; margin: 40px auto; padding: 0 16px; }
    input { width: 100%; padding: 10px; margin: 6px 0 14px; }
    button { padding: 10px 14px; cursor: pointer; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    .card { border: 1px solid #ddd; border-radius: 12px; padding: 16px; }
    pre { background: #f6f8fa; padding: 12px; border-radius: 10px; overflow-x: auto; }
    small { color: #555; }
  </style>
</head>
<body>
  <h1>Diabetes Prediction Demo</h1>
  <p><small>Calls the live FastAPI endpoint deployed on Render.</small></p>

  <div class="card">
    <div class="row">
      <div><label>Pregnancies</label><input id="Pregnancies" type="number" step="1" value="2"></div>
      <div><label>Glucose</label><input id="Glucose" type="number" step="1" value="120"></div>
      <div><label>BloodPressure</label><input id="BloodPressure" type="number" step="1" value="70"></div>
      <div><label>SkinThickness</label><input id="SkinThickness" type="number" step="1" value="20"></div>
      <div><label>Insulin</label><input id="Insulin" type="number" step="1" value="79"></div>
      <div><label>BMI</label><input id="BMI" type="number" step="0.1" value="28.0"></div>
      <div><label>DiabetesPedigreeFunction</label><input id="DiabetesPedigreeFunction" type="number" step="0.01" value="0.5"></div>
      <div><label>Age</label><input id="Age" type="number" step="1" value="33"></div>
    </div>

    <button id="btn">Predict</button>
    <p id="status"></p>
    <pre id="out"></pre>
  </div>

  <script>
    const BASE_URL = "https://deployment-buhj.onrender.com";
    const ids = ["Pregnancies","Glucose","BloodPressure","SkinThickness","Insulin","BMI","DiabetesPedigreeFunction","Age"];

    function payloadFromForm() {
      const p = {};
      for (const id of ids) p[id] = Number(document.getElementById(id).value);
      return p;
    }

    document.getElementById("btn").addEventListener("click", async () => {
      const status = document.getElementById("status");
      const out = document.getElementById("out");
      status.textContent = "Calling API...";
      out.textContent = "";

      try {
        const r = await fetch(`${BASE_URL}/predict`, {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify(payloadFromForm())
        });

        const data = await r.json();
        if (!r.ok) throw new Error(JSON.stringify(data));

        status.textContent = `OK â€” prediction=${data.prediction} prob=${Number(data.probability).toFixed(3)}`;
        out.textContent = JSON.stringify(data, null, 2);
      } catch (e) {
        status.textContent = "Error (check CORS if this is in a browser)";
        out.textContent = String(e);
      }
    });
  </script>
</body>
</html>
